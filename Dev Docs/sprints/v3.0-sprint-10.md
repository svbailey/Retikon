# V3.0 Sprint 10 - Multi-tenancy + metering + release hardening

Dates: TBD
Owner: TBD

## Goal
Basic tenant scoping, usage metering, and production readiness.

## Scope checklist
- [x] Add tenancy model retikon_core/tenancy/ (org/site/stream).
- [x] Add scoped JWT claims and auth enforcement retikon_core/auth/.
- [x] Add metering retikon_core/metering/ and GraphAr schema additions.
- [x] Update GCP services to enforce scopes in gcp_adapter/ingestion_service.py and gcp_adapter/query_service.py.
- [x] Add autoscaling configuration in Terraform (infrastructure/terraform/). (existing vars verified)
- [x] Update Dev Docs/pro/Load-Testing.md with streaming/compaction benchmarks.
- [x] Add text-only vs multimodal query baselines to Dev Docs/pro/Load-Testing.md.
- [x] Update Dev Docs/Release-Checklist.md for v3.0.

## Primary paths
- `retikon_core/tenancy/`
- `retikon_core/auth/`
- `retikon_core/metering/`
- `gcp_adapter/ingestion_service.py`
- `gcp_adapter/query_service.py`
- `infrastructure/terraform/`
- `Dev Docs/pro/Load-Testing.md`
- `Dev Docs/Release-Checklist.md`

## Tests and validation
- [x] `tests/test_query_auth.py`
- [x] `tests/test_metering.py`
- [x] `python -m ruff check .`
- [x] `python -m pytest -q` (75 passed, 7 warnings)

## Deliverables
- [x] Pro MVP feature set complete
- [ ] v3.0 release checklist satisfied

## Risks / Dependencies
- [ ] FastAPI `on_event` deprecation warnings (gcp_adapter/query_service.py, local_adapter/query_service.py).
- [ ] google._upb._message DeprecationWarning (upstream protobuf).
- [ ] torch numpy init warning in tests (torch/nn/modules/transformer.py).

## Notes
- Tests last run: 2026-01-27.
- Streaming ingest knee sweep recorded in `Dev Docs/pro/Load-Testing.md` (2026-01-27).
